<!DOCTYPE html>
<html>
<head>
    <title>Barron Canyon - Backpaddle</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; }
        #map { height: 100vh; width: 100%; }
        .header-bar {
            position: absolute; top: 0; left: 0; right: 0;
            background: linear-gradient(135deg, #1a472a 0%, #2d5a3f 100%);
            color: white; padding: 10px 15px; z-index: 1000;
            display: flex; justify-content: space-between; align-items: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
        }
        .header-bar a { color: white; text-decoration: none; }
        .header-bar h1 { font-size: 1rem; font-weight: 500; }
        .info-panel {
            position: absolute; bottom: 0; left: 0; right: 0;
            background: white; border-radius: 16px 16px 0 0;
            box-shadow: 0 -2px 20px rgba(0,0,0,0.15); z-index: 1000;
            max-height: 50vh; transition: transform 0.3s ease;
        }
        .info-panel.collapsed { transform: translateY(calc(100% - 50px)); }
        .panel-handle { width: 40px; height: 4px; background: #ccc; border-radius: 2px; margin: 10px auto; cursor: pointer; }
        .panel-header { display: flex; justify-content: space-between; align-items: center; padding: 0 15px 10px; border-bottom: 1px solid #eee; }
        .panel-header h2 { font-size: 15px; color: #333; }
        .toggle-btn { background: none; border: none; font-size: 20px; cursor: pointer; }
        .panel-content { padding: 15px; overflow-y: auto; max-height: calc(50vh - 70px); }
        .panel-content p { font-size: 13px; color: #666; margin-bottom: 6px; }
        .btn { display: block; background: #1a472a; color: white; text-align: center; padding: 12px; border-radius: 8px; text-decoration: none; font-size: 13px; margin-top: 12px; }
        .layer-toggle { display: flex; gap: 5px; margin-top: 10px; }
        .layer-btn { flex: 1; padding: 8px; border: 1px solid #ddd; background: white; border-radius: 6px; font-size: 12px; cursor: pointer; }
        .layer-btn.active { background: #1a472a; color: white; border-color: #1a472a; }
        .distance-marker { background: #FF5722; color: white; border-radius: 50%; width: 20px; height: 20px; text-align: center; line-height: 20px; font-size: 9px; font-weight: bold; border: 2px solid white; box-shadow: 0 2px 5px rgba(0,0,0,0.3); }
        .start-marker { background: #4CAF50; width: 24px; height: 24px; line-height: 24px; }
        .end-marker { background: #f44336; width: 24px; height: 24px; line-height: 24px; }
        @media (min-width: 600px) {
            .info-panel { top: 60px; bottom: auto; left: auto; right: 15px; width: 280px; border-radius: 12px; max-height: calc(100vh - 80px); }
            .info-panel.collapsed { transform: translateY(0); }
            .info-panel.collapsed .panel-content { display: none; }
            .panel-handle { display: none; }
        }
    </style>
</head>
<body>
    <div class="header-bar">
        <a href="../../">‚Üê Back</a>
        <a href="../../"><h1>üõ∂ Barron Canyon</h1></a>
        <span style="width:40px"></span>
    </div>
    <div id="map"></div>
    <div class="info-panel" id="infoPanel">
        <div class="panel-handle" onclick="togglePanel()"></div>
        <div class="panel-header"><h2>Route Details</h2><button class="toggle-btn" onclick="togglePanel()">‚àí</button></div>
        <div class="panel-content">
            <p><strong>Distance:</strong> 27 km</p>
            <p><strong>Region:</strong> Algonquin</p>
            <p><strong>Date:</strong> Oct 2022</p>
            <p><strong>Note:</strong> üöß 14 portages</p>
            <a href="route.gpx" download class="btn">üì• Download GPX</a>
            <div class="layer-toggle">
                <button class="layer-btn active" data-layer="topo">Topo</button>
                <button class="layer-btn" data-layer="satellite">Satellite</button>
                <button class="layer-btn" data-layer="street">Street</button>
            </div>
        </div>
    </div>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
        const routeCoords = [[45.889077,-77.680614],[45.888836,-77.680553],[45.888302,-77.681102],[45.887965,-77.681176],[45.887986,-77.681217],[45.887889,-77.681148],[45.887885,-77.681098],[45.88791,-77.68109],[45.88782,-77.681399],[45.88734,-77.682114],[45.886708,-77.682156],[45.885962,-77.682063],[45.885038,-77.681856],[45.884301,-77.681699],[45.88409,-77.681716],[45.884176,-77.681769],[45.884093,-77.681746],[45.884076,-77.682059],[45.883587,-77.68214],[45.883098,-77.682147],[45.882392,-77.682646],[45.881743,-77.683038],[45.88138,-77.683346],[45.881352,-77.683263],[45.881341,-77.683247],[45.881415,-77.683329],[45.881274,-77.683167],[45.88136,-77.683302],[45.881368,-77.68331],[45.881211,-77.68365],[45.880586,-77.683651],[45.880139,-77.683443],[45.879897,-77.683547],[45.879922,-77.683486],[45.879882,-77.683553],[45.879852,-77.683694],[45.879858,-77.683658],[45.879861,-77.683575],[45.8799,-77.683581],[45.879839,-77.683629],[45.879499,-77.683474],[45.879109,-77.683304],[45.878544,-77.683731],[45.878477,-77.683899],[45.878429,-77.683765],[45.878369,-77.683673],[45.878346,-77.683583],[45.878366,-77.683708],[45.878414,-77.683772],[45.878402,-77.683761],[45.878303,-77.683602],[45.878226,-77.684033],[45.877996,-77.684279],[45.877777,-77.68428],[45.87744,-77.6843],[45.877234,-77.684506],[45.876893,-77.684691],[45.876295,-77.684631],[45.876177,-77.684685],[45.876101,-77.684717],[45.876073,-77.684702],[45.876086,-77.684814],[45.875709,-77.684905],[45.875092,-77.685109],[45.874869,-77.684871],[45.87492,-77.684949],[45.874816,-77.684965],[45.874874,-77.684896],[45.874814,-77.684882],[45.874601,-77.684702],[45.874365,-77.684077],[45.874435,-77.684351],[45.874381,-77.68415],[45.874415,-77.684209],[45.874318,-77.684156],[45.874396,-77.683947],[45.874354,-77.683852],[45.874283,-77.683952],[45.874277,-77.683912],[45.874269,-77.683892],[45.874329,-77.683909],[45.874357,-77.68368],[45.874172,-77.683032],[45.874014,-77.682453],[45.873854,-77.682129],[45.873417,-77.681737],[45.87288,-77.681308],[45.872622,-77.681159],[45.872106,-77.680505],[45.871679,-77.680225],[45.871637,-77.680297],[45.871686,-77.680337],[45.87172,-77.680247],[45.871721,-77.680223],[45.871714,-77.680235],[45.871705,-77.680258],[45.871697,-77.680265],[45.871694,-77.68027],[45.871038,-77.680519],[45.870477,-77.680981],[45.869425,-77.68182],[45.868228,-77.682589],[45.867648,-77.683037],[45.866681,-77.683721],[45.865974,-77.684867],[45.865277,-77.685874],[45.864415,-77.686578],[45.863528,-77.686766],[45.862686,-77.687315],[45.861498,-77.687854],[45.861218,-77.687878],[45.861308,-77.688063],[45.861231,-77.687963],[45.861234,-77.688038],[45.861257,-77.688033],[45.861022,-77.687909],[45.860666,-77.687856],[45.860408,-77.687784],[45.860011,-77.687835],[45.859482,-77.688115],[45.858807,-77.687948],[45.85829,-77.687717],[45.857839,-77.687929],[45.85738,-77.688235],[45.856794,-77.688507],[45.856522,-77.688801],[45.85654,-77.688827],[45.85653,-77.688817],[45.855687,-77.689045],[45.855235,-77.688949],[45.854726,-77.688978],[45.854002,-77.689289],[45.853215,-77.689336],[45.852085,-77.688825],[45.85134,-77.68874],[45.850174,-77.688726],[45.849346,-77.688838],[45.848065,-77.68855],[45.846451,-77.68851],[45.845414,-77.688968],[45.844123,-77.689651],[45.843485,-77.690274],[45.843499,-77.690458],[45.843503,-77.690438],[45.843527,-77.690527],[45.843708,-77.690467],[45.843677,-77.690487],[45.853123,-77.686385],[45.85307,-77.686423],[45.853116,-77.686398],[45.853128,-77.686195],[45.853225,-77.6856],[45.853695,-77.685255],[45.854075,-77.684569],[45.854226,-77.684137],[45.854349,-77.68355],[45.854436,-77.682814],[45.854449,-77.682391],[45.854439,-77.681992],[45.854478,-77.681713],[45.854534,-77.681321],[45.854804,-77.680403],[45.854915,-77.679496],[45.855005,-77.67881],[45.85531,-77.678202],[45.855224,-77.678204],[45.854899,-77.678659],[45.854817,-77.679108],[45.854659,-77.680259],[45.854444,-77.681288],[45.854583,-77.681177],[45.854751,-77.680654],[45.854768,-77.679413],[45.855006,-77.67865],[45.855304,-77.678203],[45.855301,-77.678074],[45.855394,-77.678109],[45.855422,-77.678153],[45.855735,-77.677177],[45.85588,-77.675784],[45.855978,-77.674581],[45.856142,-77.673169],[45.85615,-77.672984],[45.856179,-77.672958],[45.856184,-77.672959],[45.856182,-77.672949],[45.856241,-77.672716],[45.856137,-77.672286],[45.856098,-77.671875],[45.855773,-77.671319],[45.855316,-77.670659],[45.854786,-77.670051],[45.85451,-77.669744],[45.854366,-77.669244],[45.854374,-77.669276],[45.854377,-77.669312],[45.854376,-77.668804],[45.854812,-77.667335],[45.855568,-77.66606],[45.85641,-77.664832],[45.857302,-77.663857],[45.858425,-77.663083],[45.859308,-77.662357],[45.859847,-77.660967],[45.859828,-77.660894],[45.859818,-77.660884],[45.859769,-77.660699],[45.859859,-77.660491],[45.859862,-77.660133],[45.859916,-77.659459],[45.860049,-77.658575],[45.86005,-77.657892],[45.859873,-77.657628],[45.859727,-77.656907],[45.859265,-77.656359],[45.859022,-77.655546],[45.858765,-77.655158],[45.858274,-77.65446],[45.857888,-77.653672],[45.857545,-77.653169],[45.857307,-77.652651],[45.857362,-77.652234],[45.857524,-77.651743],[45.857858,-77.650948],[45.858032,-77.650552],[45.858428,-77.649887],[45.858718,-77.649466],[45.859093,-77.648658],[45.859358,-77.64809],[45.85963,-77.647486],[45.859874,-77.646771],[45.860163,-77.64592],[45.860524,-77.645367],[45.860847,-77.644956],[45.861322,-77.644326],[45.861575,-77.64388],[45.861832,-77.643623],[45.861959,-77.643348],[45.862194,-77.6432],[45.862495,-77.642848],[45.863202,-77.64276],[45.863689,-77.642421],[45.864014,-77.642052],[45.864526,-77.641737],[45.86516,-77.641736],[45.865729,-77.64153],[45.866016,-77.641179],[45.865952,-77.641165],[45.86594,-77.641105],[45.866008,-77.64122],[45.865962,-77.641189],[45.866017,-77.64118],[45.86597,-77.641128],[45.865975,-77.641134],[45.866109,-77.640993],[45.865978,-77.64112],[45.865968,-77.641139],[45.865976,-77.641138],[45.865934,-77.64114],[45.865983,-77.641084],[45.865988,-77.641101],[45.865993,-77.641111],[45.865989,-77.641115],[45.866006,-77.641133],[45.865968,-77.641125],[45.865997,-77.641125],[45.865981,-77.641134],[45.865997,-77.641114],[45.866005,-77.641107],[45.866187,-77.640299],[45.866227,-77.639395],[45.866144,-77.638699],[45.865912,-77.638592],[45.865278,-77.638066],[45.865207,-77.637816],[45.865278,-77.637993],[45.865263,-77.637827],[45.864975,-77.637959],[45.864957,-77.637985],[45.865115,-77.638065],[45.865243,-77.638182],[45.865371,-77.6383],[45.865498,-77.638418],[45.865626,-77.638535],[45.865754,-77.638653],[45.865881,-77.638771],[45.866009,-77.638888],[45.866137,-77.639006],[45.866264,-77.639124],[45.866392,-77.639241],[45.867014,-77.640095],[45.86777,-77.641062],[45.86843,-77.642153],[45.8691,-77.64303],[45.869641,-77.643819],[45.87044,-77.64543],[45.871201,-77.646792],[45.871231,-77.647137],[45.871252,-77.647471],[45.87122,-77.648086],[45.871788,-77.648969],[45.872364,-77.64965],[45.872993,-77.649932],[45.873298,-77.650564],[45.873452,-77.6514],[45.873775,-77.651793],[45.874054,-77.652333],[45.874234,-77.652755],[45.874111,-77.653378],[45.874161,-77.653868],[45.874161,-77.653853],[45.874165,-77.653859],[45.874345,-77.654705],[45.875007,-77.656206],[45.875464,-77.657058],[45.876316,-77.658679],[45.876795,-77.659735],[45.877104,-77.660614],[45.877646,-77.661906],[45.87825,-77.663843],[45.878707,-77.665182],[45.879493,-77.666361],[45.880002,-77.666848],[45.880031,-77.666876],[45.880044,-77.666816],[45.880043,-77.666819],[45.880924,-77.666731],[45.881447,-77.66643],[45.881746,-77.666257],[45.882096,-77.665819],[45.882534,-77.665103],[45.883087,-77.665105],[45.883841,-77.6653],[45.884226,-77.665369],[45.884553,-77.664853],[45.884974,-77.664704],[45.885464,-77.664121],[45.885704,-77.66395],[45.885685,-77.66398],[45.885683,-77.663972],[45.885679,-77.663965],[45.885686,-77.663976],[45.885697,-77.663971],[45.885704,-77.663969],[45.886017,-77.664157],[45.886476,-77.66463],[45.886573,-77.66579],[45.886657,-77.666526],[45.886943,-77.667423],[45.887064,-77.668268],[45.887259,-77.669347],[45.887542,-77.670395],[45.887626,-77.671312],[45.887744,-77.672404],[45.887799,-77.672474],[45.887716,-77.6718],[45.887641,-77.67037],[45.887311,-77.669022],[45.887033,-77.667791],[45.886791,-77.666795],[45.886658,-77.665124],[45.886708,-77.663901],[45.886867,-77.662694],[45.886936,-77.661361],[45.887161,-77.660325],[45.887097,-77.659349],[45.88711,-77.659322],[45.887021,-77.659364],[45.887118,-77.65932],[45.887085,-77.658652],[45.886951,-77.657721],[45.886836,-77.65795],[45.886793,-77.65834],[45.886875,-77.657911],[45.886883,-77.657837],[45.886858,-77.657934],[45.886823,-77.657885],[45.886823,-77.657909],[45.886827,-77.657922],[45.886835,-77.657901],[45.886838,-77.657898],[45.88684,-77.657888],[45.886858,-77.65791],[45.886875,-77.657778],[45.886881,-77.657757],[45.886878,-77.656792],[45.886864,-77.656306],[45.886835,-77.656358],[45.886799,-77.656352],[45.886667,-77.655649],[45.886424,-77.655256],[45.886079,-77.654552],[45.885774,-77.654093],[45.88562,-77.653283],[45.885508,-77.652637],[45.885291,-77.652012],[45.885172,-77.651667],[45.88508,-77.651188],[45.884897,-77.651082],[45.884856,-77.651087],[45.884995,-77.651118],[45.884937,-77.650987],[45.884991,-77.650534],[45.885023,-77.649454],[45.885028,-77.648241],[45.884941,-77.64722],[45.88495,-77.645856],[45.88472,-77.644821],[45.884507,-77.643717],[45.884413,-77.641995],[45.884423,-77.641156],[45.884516,-77.639978],[45.884412,-77.638925],[45.884542,-77.637792],[45.884662,-77.636681],[45.884825,-77.635214],[45.885006,-77.634532],[45.885223,-77.63363],[45.88577,-77.632337],[45.885998,-77.631174],[45.886187,-77.630402],[45.886628,-77.628949],[45.886578,-77.628483],[45.886669,-77.628522],[45.886685,-77.628548],[45.886684,-77.628589],[45.886877,-77.627547],[45.887146,-77.626094],[45.887332,-77.624161],[45.887324,-77.623003],[45.887213,-77.621906],[45.887097,-77.621003],[45.887215,-77.62006],[45.887109,-77.618995],[45.886747,-77.617478],[45.886701,-77.616686],[45.886503,-77.615452],[45.886209,-77.613953],[45.885779,-77.612219],[45.885298,-77.610307],[45.88485,-77.608737],[45.88486,-77.607182],[45.885092,-77.605557],[45.885113,-77.60529],[45.885119,-77.605242],[45.885068,-77.605247],[45.884695,-77.603754],[45.884218,-77.601713],[45.883934,-77.600751],[45.883484,-77.599457],[45.883038,-77.597562],[45.883089,-77.597298],[45.883258,-77.597307],[45.883017,-77.597454],[45.883319,-77.597224],[45.883131,-77.597224],[45.883105,-77.59733],[45.883117,-77.597332],[45.883273,-77.597317],[45.883096,-77.597281],[45.883123,-77.597335],[45.883104,-77.59728],[45.883148,-77.597245],[45.883147,-77.597254],[45.883241,-77.597258],[45.883285,-77.597298],[45.883292,-77.597291],[45.883295,-77.59729],[45.883296,-77.597284],[45.883339,-77.597247],[45.883316,-77.597203],[45.883316,-77.59735],[45.883192,-77.597201],[45.88319,-77.597219],[45.883141,-77.597174],[45.883177,-77.597136],[45.883151,-77.596995],[45.883118,-77.597034],[45.883238,-77.597077],[45.883271,-77.597078],[45.883319,-77.597308],[45.883188,-77.597004],[45.883233,-77.597009],[45.883199,-77.597038],[45.883195,-77.597044],[45.883181,-77.59706],[45.883133,-77.596997],[45.877372,-77.578304],[45.87712,-77.57766],[45.877018,-77.577014],[45.876871,-77.576312],[45.876609,-77.575752],[45.876066,-77.574989],[45.875774,-77.574968],[45.875684,-77.574928],[45.875305,-77.574519],[45.874945,-77.574641],[45.874646,-77.573247],[45.874184,-77.571472],[45.873903,-77.570015],[45.873505,-77.568358],[45.87307,-77.566422],[45.872669,-77.564541],[45.872347,-77.563406],[45.871962,-77.561634],[45.871828,-77.560684],[45.871841,-77.560692],[45.871799,-77.560792],[45.87187,-77.560633],[45.87183,-77.560671],[45.871831,-77.560615]];
        const waypoints = [{"lat":45.889077,"lng":-77.680614,"label":"Start","type":"start"},{"lat":45.85584,"lng":-77.671459,"label":"10"},{"lat":45.886818,"lng":-77.657956,"label":"20"},{"lat":45.871831,"lng":-77.560615,"label":"End","type":"end"}];
        const cyclosm = L.tileLayer('https://{s}.tile-cyclosm.openstreetmap.fr/cyclosm/{z}/{x}/{y}.png', {subdomains: 'abc', maxZoom: 20});
        const topo = L.tileLayer('https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png', {maxZoom: 17});
        const satellite = L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', {maxZoom: 18});
        const street = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {maxZoom: 19});
        const layers = {cyclosm, topo, satellite, street};
        let currentLayer = 'topo';
        const map = L.map('map', {center: [45.866281, -77.62557100000001], zoom: 12, layers: [topo], zoomControl: false});
        L.control.zoom({position: 'topleft'}).addTo(map);
        const routeLine = L.polyline(routeCoords, {color: '#FF5722', weight: 4, opacity: 0.8}).addTo(map);
        map.fitBounds(routeLine.getBounds().pad(0.1));
        waypoints.forEach(wp => {
            let cls = 'distance-marker';
            if (wp.type === 'start') cls += ' start-marker';
            if (wp.type === 'end') cls += ' end-marker';
            const icon = L.divIcon({className: '', html: '<div class="'+cls+'">'+(wp.type === 'start' ? '‚ñ∂' : wp.type === 'end' ? '‚óº' : wp.label)+'</div>', iconSize: [20,20], iconAnchor: [10,10]});
            L.marker([wp.lat, wp.lng], {icon}).addTo(map);
        });
        document.querySelectorAll('.layer-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.layer-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                map.removeLayer(layers[currentLayer]);
                layers[btn.dataset.layer].addTo(map);
                currentLayer = btn.dataset.layer;
            });
        });
        function togglePanel() { document.getElementById('infoPanel').classList.toggle('collapsed'); }
        if (window.innerWidth < 600) document.getElementById('infoPanel').classList.add('collapsed');
    </script>
</body>
</html>