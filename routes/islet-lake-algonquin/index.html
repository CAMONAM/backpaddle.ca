<!DOCTYPE html>
<html>
<head>
    <title>Islet Lake ‚Äî Algonquin Fall - Backpaddle</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; }
        #map { height: 100vh; width: 100%; }
        .header-bar {
            position: absolute; top: 0; left: 0; right: 0;
            background: linear-gradient(135deg, #1a472a 0%, #2d5a3f 100%);
            color: white; padding: 10px 15px; z-index: 1000;
            display: flex; justify-content: space-between; align-items: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
        }
        .header-bar a { color: white; text-decoration: none; }
        .header-bar h1 { font-size: 1rem; font-weight: 500; }
        .info-panel {
            position: absolute; bottom: 0; left: 0; right: 0;
            background: white; border-radius: 16px 16px 0 0;
            box-shadow: 0 -2px 20px rgba(0,0,0,0.15); z-index: 1000;
            max-height: 50vh; transition: transform 0.3s ease;
        }
        .info-panel.collapsed { transform: translateY(calc(100% - 50px)); }
        .panel-handle { width: 40px; height: 4px; background: #ccc; border-radius: 2px; margin: 10px auto; cursor: pointer; }
        .panel-header { display: flex; justify-content: space-between; align-items: center; padding: 0 15px 10px; border-bottom: 1px solid #eee; }
        .panel-header h2 { font-size: 15px; color: #333; }
        .toggle-btn { background: none; border: none; font-size: 20px; cursor: pointer; }
        .panel-content { padding: 15px; overflow-y: auto; max-height: calc(50vh - 70px); }
        .panel-content p { font-size: 13px; color: #666; margin-bottom: 6px; }
        .btn { display: block; background: #1a472a; color: white; text-align: center; padding: 12px; border-radius: 8px; text-decoration: none; font-size: 13px; margin-top: 12px; }
        .layer-toggle { display: flex; gap: 5px; margin-top: 10px; }
        .layer-btn { flex: 1; padding: 8px; border: 1px solid #ddd; background: white; border-radius: 6px; font-size: 12px; cursor: pointer; }
        .layer-btn.active { background: #1a472a; color: white; border-color: #1a472a; }
        .distance-marker { background: #FF5722; color: white; border-radius: 50%; width: 20px; height: 20px; text-align: center; line-height: 20px; font-size: 9px; font-weight: bold; border: 2px solid white; box-shadow: 0 2px 5px rgba(0,0,0,0.3); }
        .start-marker { background: #4CAF50; width: 24px; height: 24px; line-height: 24px; }
        .end-marker { background: #f44336; width: 24px; height: 24px; line-height: 24px; }
        @media (min-width: 600px) {
            .info-panel { top: 60px; bottom: auto; left: auto; right: 15px; width: 280px; border-radius: 12px; max-height: calc(100vh - 80px); }
            .info-panel.collapsed { transform: translateY(0); }
            .info-panel.collapsed .panel-content { display: none; }
            .panel-handle { display: none; }
        }
    </style>
<script src="/gate.js"></script>
</head>
<body>
    <div class="header-bar">
        <a href="../../">‚Üê Back</a>
        <a href="../../"><h1>üõ∂ Islet Lake ‚Äî Algonquin Fall</h1></a>
        <span style="width:40px"></span>
    </div>
    <div id="map"></div>
    <div class="info-panel" id="infoPanel">
        <div class="panel-handle" onclick="togglePanel()"></div>
        <div class="panel-header"><h2>Route Details</h2><button class="toggle-btn" onclick="togglePanel()">‚àí</button></div>
        <div class="panel-content">
            <p><strong>Distance:</strong> 22 km</p>
            <p><strong>Region:</strong> Algonquin</p>
            <p><strong>Date:</strong> Oct 2022</p>
            
            <a href="route.gpx" download class="btn">üì• Download GPX</a>
            <div class="layer-toggle">
                <button class="layer-btn active" data-layer="topo">Topo</button>
                <button class="layer-btn" data-layer="satellite">Satellite</button>
            </div>
        </div>
    </div>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
        const routeCoords = [[45.611793,-78.942553],[45.612267,-78.94237],[45.61259,-78.941803],[45.613217,-78.941078],[45.613417,-78.940764],[45.613815,-78.940252],[45.614233,-78.939781],[45.614711,-78.939244],[45.615205,-78.93856],[45.615949,-78.93767],[45.616635,-78.937002],[45.617338,-78.935992],[45.617887,-78.935127],[45.61817,-78.934468],[45.618432,-78.933745],[45.618556,-78.933194],[45.618632,-78.932354],[45.618916,-78.931566],[45.61905,-78.931056],[45.619001,-78.930644],[45.618967,-78.930576],[45.618942,-78.930504],[45.618936,-78.930535],[45.618941,-78.930497],[45.618947,-78.930485],[45.61893,-78.930483],[45.618947,-78.930448],[45.618904,-78.930429],[45.618935,-78.930438],[45.618914,-78.930428],[45.618783,-78.930045],[45.618697,-78.929856],[45.61839,-78.930003],[45.618075,-78.930118],[45.617724,-78.930096],[45.617112,-78.930006],[45.616495,-78.92979],[45.615752,-78.929784],[45.615199,-78.929939],[45.614902,-78.929996],[45.614529,-78.930159],[45.613999,-78.930381],[45.613514,-78.930474],[45.613038,-78.93057],[45.612552,-78.930633],[45.612112,-78.930531],[45.61158,-78.930566],[45.611301,-78.930561],[45.610818,-78.930467],[45.610486,-78.930234],[45.610021,-78.9299],[45.609426,-78.929863],[45.608963,-78.92975],[45.608586,-78.929573],[45.608258,-78.929281],[45.607873,-78.929048],[45.607365,-78.92903],[45.606923,-78.928998],[45.606629,-78.929114],[45.606291,-78.928999],[45.605936,-78.928664],[45.605712,-78.928402],[45.605292,-78.927891],[45.60497,-78.928072],[45.60501,-78.928036],[45.605147,-78.927732],[45.605065,-78.92765],[45.605072,-78.927678],[45.604968,-78.928021],[45.6049,-78.928083],[45.604919,-78.928149],[45.604918,-78.928107],[45.604916,-78.928094],[45.604917,-78.928095],[45.604698,-78.928084],[45.604445,-78.92796],[45.604335,-78.92779],[45.603996,-78.927753],[45.603594,-78.92776],[45.603192,-78.927775],[45.60254,-78.927775],[45.60189,-78.927793],[45.601163,-78.927715],[45.600792,-78.927599],[45.60049,-78.927535],[45.600065,-78.927326],[45.599465,-78.926646],[45.598902,-78.926043],[45.598479,-78.925622],[45.597917,-78.925087],[45.5974,-78.924759],[45.596898,-78.924304],[45.596489,-78.923908],[45.595907,-78.923404],[45.595733,-78.92331],[45.595657,-78.923193],[45.595281,-78.922974],[45.595,-78.922715],[45.594975,-78.922497],[45.594882,-78.922433],[45.594828,-78.922476],[45.594813,-78.922518],[45.594814,-78.922559],[45.594811,-78.922554],[45.594827,-78.922535],[45.594818,-78.922499],[45.594712,-78.922005],[45.594583,-78.921815],[45.594268,-78.921503],[45.593928,-78.92127],[45.59351,-78.921096],[45.593195,-78.921075],[45.592773,-78.921004],[45.592352,-78.92087],[45.592071,-78.920789],[45.591618,-78.920515],[45.591351,-78.91987],[45.591125,-78.918994],[45.590953,-78.918516],[45.590703,-78.917744],[45.590611,-78.917416],[45.590501,-78.917117],[45.590414,-78.916733],[45.590195,-78.915909],[45.589856,-78.914638],[45.589649,-78.913824],[45.589509,-78.913209],[45.589426,-78.912397],[45.589413,-78.911957],[45.5894,-78.911274],[45.589368,-78.910366],[45.589438,-78.909792],[45.589739,-78.908774],[45.590308,-78.908551],[45.59082,-78.908117],[45.591239,-78.907709],[45.59183,-78.90709],[45.591824,-78.906345],[45.591737,-78.905697],[45.591712,-78.904961],[45.591789,-78.904464],[45.591765,-78.904203],[45.591762,-78.9041],[45.591707,-78.904102],[45.591699,-78.904098],[45.591693,-78.904089],[45.591694,-78.904095],[45.591719,-78.904065],[45.591721,-78.904065],[45.591732,-78.904082],[45.591797,-78.904145],[45.592075,-78.903904],[45.592154,-78.903672],[45.592248,-78.903538],[45.592191,-78.903569],[45.59221,-78.90332],[45.592316,-78.903086],[45.592461,-78.902773],[45.592567,-78.902611],[45.592837,-78.902117],[45.593064,-78.901939],[45.593193,-78.901788],[45.593173,-78.901769],[45.593249,-78.901675],[45.593336,-78.901527],[45.593475,-78.901522],[45.593548,-78.901405],[45.593642,-78.901446],[45.593856,-78.901125],[45.594024,-78.901076],[45.594117,-78.901036],[45.594345,-78.900948],[45.594566,-78.90083],[45.594872,-78.900513],[45.595011,-78.900325],[45.59516,-78.900031],[45.595266,-78.899535],[45.595249,-78.899206],[45.595195,-78.898981],[45.594898,-78.898627],[45.594694,-78.898211],[45.594287,-78.89803],[45.594085,-78.897833],[45.594219,-78.897729],[45.594368,-78.897469],[45.594489,-78.897229],[45.594564,-78.897248],[45.594548,-78.897259],[45.595022,-78.896584],[45.595422,-78.89612],[45.595482,-78.896018],[45.595499,-78.895982],[45.595615,-78.896039],[45.59559,-78.895684],[45.595755,-78.895492],[45.595948,-78.89542],[45.596116,-78.895441],[45.596494,-78.895491],[45.596716,-78.895611],[45.59706,-78.895796],[45.597332,-78.895346],[45.597507,-78.894897],[45.597648,-78.894526],[45.597716,-78.894162],[45.597816,-78.893974],[45.598154,-78.893854],[45.598504,-78.893869],[45.598826,-78.89391],[45.599083,-78.893933],[45.59923,-78.893842],[45.599494,-78.893527],[45.599725,-78.893319],[45.599741,-78.893322],[45.599764,-78.893314],[45.599767,-78.893286],[45.599767,-78.89328],[45.599768,-78.893266],[45.599768,-78.893261],[45.599772,-78.893258],[45.59977,-78.893258],[45.599775,-78.893255],[45.599793,-78.893229],[45.599799,-78.893216],[45.60001,-78.892961],[45.600097,-78.892845],[45.600211,-78.892718],[45.600292,-78.892657],[45.600429,-78.892456],[45.600516,-78.892332],[45.600708,-78.892084],[45.601027,-78.891768],[45.601247,-78.891516],[45.601448,-78.891262],[45.601937,-78.890679],[45.602397,-78.890042],[45.602962,-78.889351],[45.603447,-78.888922],[45.604018,-78.888635],[45.604705,-78.888374],[45.605558,-78.888138],[45.60643,-78.888018],[45.607219,-78.888196],[45.607679,-78.888035],[45.60838,-78.887704],[45.609159,-78.88742],[45.609765,-78.8872],[45.610402,-78.886957],[45.611348,-78.886318],[45.611801,-78.88566],[45.612337,-78.884955],[45.612493,-78.884787],[45.612462,-78.884735],[45.612554,-78.884605],[45.612499,-78.884583],[45.612709,-78.884579],[45.612835,-78.884598],[45.612648,-78.884536],[45.612515,-78.884572],[45.61262,-78.884428],[45.612683,-78.884418],[45.612727,-78.884409],[45.612732,-78.884403],[45.612741,-78.884411],[45.613307,-78.884868],[45.613582,-78.885162],[45.614038,-78.885786],[45.614302,-78.886272],[45.61477,-78.887131],[45.614796,-78.887371],[45.614867,-78.887558],[45.615322,-78.888097],[45.61597,-78.888851],[45.616549,-78.889435],[45.616801,-78.888875],[45.616708,-78.889077],[45.616836,-78.889619],[45.617119,-78.889971],[45.617867,-78.890069],[45.618895,-78.890424],[45.619518,-78.890263],[45.619949,-78.890152],[45.620151,-78.890169],[45.620108,-78.890226],[45.620203,-78.890122],[45.620243,-78.890109],[45.62038,-78.890137],[45.62023,-78.890302],[45.62009,-78.890315],[45.620107,-78.890325],[45.619762,-78.89059],[45.619544,-78.890851],[45.619781,-78.890635],[45.620071,-78.890389],[45.620174,-78.890197],[45.620191,-78.890178],[45.620122,-78.890128],[45.620165,-78.88983],[45.620246,-78.889175],[45.620222,-78.888567],[45.620193,-78.888117],[45.620178,-78.887081],[45.620485,-78.886333],[45.621041,-78.886027],[45.621568,-78.885682],[45.622138,-78.885415],[45.622448,-78.88541],[45.622545,-78.885416],[45.622644,-78.88572],[45.622436,-78.886197],[45.622212,-78.886364],[45.621821,-78.886725],[45.621551,-78.886924],[45.62115,-78.887192],[45.620804,-78.88742],[45.620484,-78.88765],[45.619885,-78.888008],[45.619378,-78.888294],[45.618856,-78.88859],[45.618425,-78.888802],[45.617982,-78.889013],[45.617858,-78.889083],[45.617753,-78.888991],[45.617722,-78.88902],[45.617806,-78.889061],[45.617841,-78.889051],[45.617642,-78.889484],[45.617216,-78.889797],[45.616876,-78.889579],[45.616883,-78.888774],[45.61678,-78.888566],[45.616791,-78.888761],[45.616897,-78.889706],[45.617403,-78.889642],[45.617865,-78.889106],[45.617837,-78.889062],[45.617855,-78.888961],[45.617601,-78.889016],[45.617709,-78.889011],[45.617711,-78.888967],[45.617668,-78.889006],[45.617687,-78.888846],[45.617647,-78.888912],[45.617681,-78.888981],[45.618194,-78.889233],[45.618223,-78.889113],[45.618535,-78.888963],[45.619193,-78.888632],[45.619817,-78.888491],[45.620672,-78.888269],[45.62109,-78.888186],[45.622299,-78.887936],[45.622894,-78.887723],[45.623756,-78.887484],[45.624562,-78.88726],[45.625265,-78.886969],[45.626145,-78.886605],[45.627032,-78.886286],[45.627591,-78.886105],[45.628224,-78.886017],[45.628973,-78.886105],[45.62952,-78.88632],[45.629905,-78.886765],[45.630443,-78.887523],[45.630783,-78.888188],[45.630969,-78.888547],[45.631075,-78.888725],[45.631084,-78.88871],[45.631097,-78.888782],[45.631112,-78.888705],[45.631112,-78.888704],[45.631111,-78.888711],[45.631097,-78.888758],[45.631072,-78.889088],[45.631056,-78.88941],[45.631106,-78.889597],[45.631084,-78.889812],[45.631127,-78.890131],[45.631105,-78.890489],[45.631079,-78.890948],[45.630962,-78.891416],[45.630827,-78.892051],[45.630799,-78.892581],[45.630675,-78.892975],[45.630616,-78.893374],[45.630559,-78.893537],[45.63037,-78.893823],[45.630124,-78.894091],[45.630141,-78.894109],[45.630204,-78.894144],[45.630189,-78.894125],[45.63023,-78.89412],[45.630214,-78.894145],[45.630264,-78.89454],[45.630326,-78.895387],[45.6304,-78.895984],[45.630486,-78.897322],[45.630635,-78.898304],[45.630745,-78.899068],[45.630832,-78.900083],[45.63096,-78.900721],[45.631075,-78.90091],[45.63109,-78.900934],[45.631094,-78.900915],[45.631074,-78.901367],[45.6312,-78.901701],[45.631431,-78.901841],[45.631534,-78.901974],[45.63178,-78.902161],[45.631979,-78.902269],[45.632374,-78.902154],[45.632627,-78.90215],[45.632862,-78.902392],[45.633178,-78.902652],[45.633354,-78.902801],[45.63348,-78.902829],[45.633709,-78.902907],[45.633791,-78.903155],[45.633889,-78.903568],[45.63393,-78.90404],[45.633762,-78.904517],[45.633485,-78.904813],[45.633269,-78.905117],[45.633084,-78.9057],[45.633085,-78.906008],[45.633046,-78.906125],[45.633103,-78.906273],[45.63314,-78.906277],[45.633114,-78.906273],[45.633125,-78.906277],[45.633189,-78.906332],[45.633032,-78.906834],[45.632873,-78.907278],[45.632528,-78.908089],[45.632192,-78.908886],[45.631837,-78.909629],[45.631481,-78.910413],[45.631275,-78.910487],[45.631057,-78.910928],[45.630711,-78.911571],[45.630364,-78.91225],[45.629875,-78.913108],[45.629626,-78.914437],[45.629642,-78.915691],[45.629716,-78.916887],[45.629805,-78.917965],[45.629429,-78.918929],[45.628986,-78.919812],[45.628547,-78.920511],[45.628109,-78.921169],[45.627439,-78.922092],[45.626805,-78.922931],[45.626134,-78.923859],[45.625634,-78.92458],[45.625109,-78.92524],[45.624389,-78.926283],[45.623803,-78.927198],[45.623317,-78.927982],[45.622721,-78.928794],[45.622071,-78.929618],[45.621609,-78.93029],[45.621064,-78.931063],[45.620559,-78.931869],[45.620173,-78.93249],[45.619495,-78.9334],[45.618905,-78.93417],[45.618421,-78.934745],[45.617777,-78.93558],[45.617326,-78.936119],[45.616682,-78.9369],[45.616857,-78.93685],[45.616616,-78.936917],[45.616323,-78.937256],[45.615687,-78.937936],[45.615336,-78.938339],[45.615029,-78.93877],[45.614414,-78.939608],[45.613827,-78.940314],[45.613301,-78.940995],[45.612684,-78.941654],[45.61223,-78.94237],[45.611725,-78.943107],[45.611145,-78.943829],[45.610738,-78.944465],[45.610191,-78.945231],[45.609671,-78.946055],[45.609098,-78.94691],[45.608665,-78.947449],[45.608283,-78.948025],[45.607662,-78.949003],[45.607136,-78.949839],[45.606657,-78.950506],[45.606135,-78.950917],[45.605522,-78.951336],[45.604916,-78.951701],[45.6042,-78.95222],[45.603732,-78.952581],[45.603692,-78.952855],[45.603691,-78.953231],[45.603736,-78.953264],[45.603594,-78.953009],[45.60362,-78.952897],[45.603661,-78.952882],[45.603652,-78.952902],[45.603698,-78.952762],[45.603682,-78.952802],[45.603622,-78.952905],[45.603653,-78.952912],[45.603642,-78.952927],[45.603639,-78.952857],[45.603616,-78.952868],[45.60364,-78.952857],[45.603637,-78.952853]];
        const waypoints = [{"lat":45.611793,"lng":-78.942553,"label":"Start","type":"start"},{"lat":45.601448,"lng":-78.891262,"label":"10"},{"lat":45.618852,"lng":-78.934227,"label":"20"},{"lat":45.603637,"lng":-78.952853,"label":"End","type":"end"}];
        const cyclosm = L.tileLayer('https://{s}.tile-cyclosm.openstreetmap.fr/cyclosm/{z}/{x}/{y}.png', {subdomains: 'abc', maxZoom: 20});
        const topo = L.tileLayer('https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png', {maxZoom: 17});
        const satellite = L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', {maxZoom: 18});
        const layers = {cyclosm, topo, satellite};
        let currentLayer = 'topo';
        const map = L.map('map', {center: [45.611649, -78.9188335], zoom: 12, layers: [topo], zoomControl: false});
        L.control.zoom({position: 'topleft'}).addTo(map);
        const routeLine = L.polyline(routeCoords, {color: '#FF5722', weight: 4, opacity: 0.8}).addTo(map);
        map.fitBounds(routeLine.getBounds().pad(0.1));
        waypoints.forEach(wp => {
            let cls = 'distance-marker';
            if (wp.type === 'start') cls += ' start-marker';
            if (wp.type === 'end') cls += ' end-marker';
            const icon = L.divIcon({className: '', html: '<div class="'+cls+'">'+(wp.type === 'start' ? '‚ñ∂' : wp.type === 'end' ? '‚óº' : wp.label)+'</div>', iconSize: [20,20], iconAnchor: [10,10]});
            L.marker([wp.lat, wp.lng], {icon}).addTo(map);
        });
        document.querySelectorAll('.layer-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.layer-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                map.removeLayer(layers[currentLayer]);
                layers[btn.dataset.layer].addTo(map);
                currentLayer = btn.dataset.layer;
            });
        });
        function togglePanel() { document.getElementById('infoPanel').classList.toggle('collapsed'); }
        if (window.innerWidth < 600) document.getElementById('infoPanel').classList.add('collapsed');
    </script>
</body>
</html>